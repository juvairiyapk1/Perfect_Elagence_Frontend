<!--dash.component.html-->
<div class="grid-container">
  <h1 class="mat-h1">Dashboard</h1>
  <mat-grid-list cols="{{ ( cardLayout | async )?.columns }}" rowHeight="200px">
    <!--Mini Cards-->
    <mat-grid-tile [colspan]="( cardLayout | async )?.miniCard?.cols"
      [rowspan]="( cardLayout | async )?.miniCard?.rows">
      <app-card title="Users">
        <div>Total Users: {{userCount}}</div>
      </app-card>
    </mat-grid-tile>

    <mat-grid-tile [colspan]="( cardLayout | async )?.miniCard?.cols"
      [rowspan]="( cardLayout | async )?.miniCard?.rows">
      <app-card title="Blocked Users">
        <div>Blocked Users: {{blockedUserCount}}</div>
      </app-card>
    </mat-grid-tile>

    <mat-grid-tile [colspan]="( cardLayout | async )?.miniCard?.cols"
      [rowspan]="( cardLayout | async )?.miniCard?.rows">
      <app-card title="Subscribers">
        <div>Subscribers: {{subscribersCount}}</div>
      </app-card>
    </mat-grid-tile>

    <mat-grid-tile [colspan]="( cardLayout | async )?.miniCard?.cols"
      [rowspan]="( cardLayout | async )?.miniCard?.rows">
      <app-card title="Unsubscribers">
        <div>Unsubscribers: {{unsubscribersCount}}</div>
      </app-card>
    </mat-grid-tile>
    <!--Charts-->
    <mat-grid-tile [colspan]="(cardLayout | async)?.chart?.cols" [rowspan]="(cardLayout | async)?.chart?.rows" >
      <app-card title="Monthly user & subscription data">
        <app-user-subscription-chart></app-user-subscription-chart>
      </app-card>
    </mat-grid-tile>

    <mat-grid-tile [colspan]="(cardLayout | async)?.chart?.cols" [rowspan]="(cardLayout | async)?.chart?.rows">
      <app-card title="Monthly Subscription Revenue">
        <app-subscription-revenue-chart></app-subscription-revenue-chart>
      </app-card>
    </mat-grid-tile>
    <!--Table-->
    <mat-grid-tile [colspan]="( cardLayout | async )?.table?.cols" [rowspan]="( cardLayout | async )?.table?.rows">
      <app-card title="Recent Subscribers">
        <div>
          <table mat-table [dataSource]="dataSource" matSort class="mat-elevation-z8">
        
            <ng-container matColumnDef="user">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>User</th>
              <td mat-cell *matCellDef="let element">{{element.user}}</td>
            </ng-container>
            
            <ng-container matColumnDef="subscriptionStartDate">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> Start Date</th>
              <td mat-cell *matCellDef="let element">{{element.sDate}}</td>
            </ng-container>
            
            <ng-container matColumnDef="subscriptionEndDate">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> End Date</th>
              <td mat-cell *matCellDef="let element">{{element.eDate}}</td>
            </ng-container>

            <ng-container matColumnDef="amount">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> Amount</th>
              <td mat-cell *matCellDef="let element">{{element.amount}}</td>
            </ng-container>
    
            <ng-container matColumnDef="status">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Status</th>
                <td mat-cell *matCellDef="let element">{{element.status}}</td>
              </ng-container>
            
            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
          </table>
        </div>

      </app-card>
    </mat-grid-tile>
  </mat-grid-list>
</div>